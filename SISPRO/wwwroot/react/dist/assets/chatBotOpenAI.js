import{r as s,I as v,_ as j,j as e,B as T,R as z}from"./getAllowClear-DzOICv91.js";import{T as D}from"./index-sl0vh_WN.js";import{F as U}from"./index-Dl1Dfgth.js";import{D as B}from"./index-Btuqp7xZ.js";import{A as C,a as k,R as L}from"./UserOutlined-DSTAynRb.js";import{L as y}from"./index-GYC7IrDe.js";import{I as A}from"./index-CYJEyo0l.js";import{S as H}from"./index-BdEWC5PL.js";import"./convertToTooltipProps-DsHUCvc1.js";import"./LeftOutlined-DM8q5vvt.js";var P={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M300 328a60 60 0 10120 0 60 60 0 10-120 0zM852 64H172c-17.7 0-32 14.3-32 32v660c0 17.7 14.3 32 32 32h680c17.7 0 32-14.3 32-32V96c0-17.7-14.3-32-32-32zm-32 660H204V128h616v596zM604 328a60 60 0 10120 0 60 60 0 10-120 0zm250.2 556H169.8c-16.5 0-29.8 14.3-29.8 32v36c0 4.4 3.3 8 7.4 8h729.1c4.1 0 7.4-3.6 7.4-8v-36c.1-17.7-13.2-32-29.7-32zM664 508H360c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"robot",theme:"outlined"},W=function(o,r){return s.createElement(v,j({},o,{ref:r,icon:P}))},g=s.forwardRef(W),$={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2a15.99 15.99 0 00-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-.9 3.7-.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 .7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-.8 4.2-2.6 5-5 1.4-4.2-.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z"}}]},name:"send",theme:"outlined"},F=function(o,r){return s.createElement(v,j({},o,{ref:r,icon:$}))},K=s.forwardRef(F);const{Text:d}=D,N=()=>{const[n,o]=s.useState([]),[r,p]=s.useState(""),[l,f]=s.useState(!1),[x,c]=s.useState(null),[w,u]=s.useState(!1),h=s.useRef(null),[b,S]=s.useState(!1),R=()=>{var t;(t=h.current)==null||t.scrollIntoView({behavior:"smooth"})};s.useEffect(()=>{R()},[n]);const I=()=>{if(u(!0),!b){const t={text:"¬°Hola! Soy tu YITPRIN tu asistente virtual ü§ñ. Estoy aqu√≠ para ayudarte a encontrar informaci√≥n sobre tareas y proyectos. ¬øEn qu√© puedo ayudarte hoy?",isUser:!1,timestamp:new Date().toLocaleTimeString()};o([t]),S(!0)}},m=async()=>{if(!r.trim())return;const t={text:r,isUser:!0,timestamp:new Date().toLocaleTimeString()};o(a=>[...a,t]),p(""),f(!0),c(null);try{console.log("Enviando mensaje:",r);const a=await fetch("http://localhost:3001/api/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:r})}),i=await a.json();if(console.log("Respuesta del servidor:",i),!a.ok)throw new Error(i.error||i.details||"Error en la respuesta del servidor");const M={text:i.response,isUser:!1,timestamp:new Date().toLocaleTimeString()};o(O=>[...O,M])}catch(a){console.error("Error:",a),c(a.message)}finally{f(!1)}},E=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),m())};return e.jsxs(e.Fragment,{children:[e.jsx(U,{icon:e.jsx(g,{style:{fontSize:"24px"}}),type:"primary",style:{right:28,bottom:20,width:"50px",height:"50px"},onClick:I}),e.jsx(B,{title:"ü§ñ YITPRIN",placement:"right",onClose:()=>u(!1),open:w,width:600,styles:{body:{padding:0,display:"flex",flexDirection:"column",height:"calc(100% - 55px)"}},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",height:"100%",padding:"16px"},children:[x&&e.jsx(C,{message:"Error",description:x,type:"error",showIcon:!0,style:{marginBottom:16},closable:!0,onClose:()=>c(null)}),e.jsx(y,{style:{flex:1,overflow:"auto",marginBottom:16},split:!1,dataSource:n,renderItem:t=>e.jsx(y.Item,{style:{justifyContent:t.isUser?"flex-end":"flex-start"},children:e.jsxs("div",{style:{maxWidth:"80%",display:"flex",alignItems:"flex-start",flexDirection:t.isUser?"row-reverse":"row"},children:[e.jsx(k,{icon:t.isUser?e.jsx(L,{}):e.jsx(g,{}),style:{backgroundColor:t.isUser?"#1890ff":"#8f12ce",margin:t.isUser?"0 0 0 8px":"0 8px 0 0",width:"32px",height:"32px",minWidth:"32px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"16px"}}),e.jsxs("div",{style:{background:t.isUser?"#1890ff":"#f0f2f5",padding:"8px 12px",borderRadius:"8px",color:t.isUser?"white":"black",wordBreak:"break-word"},children:[e.jsx(d,{style:{color:t.isUser?"white":"rgba(0, 0, 0, 0.85)"},children:t.text}),e.jsx("div",{children:e.jsx(d,{type:"secondary",style:{fontSize:"12px",color:t.isUser?"rgba(255, 255, 255, 0.75)":""},children:t.timestamp})})]})]})})}),e.jsx("div",{ref:h}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:"auto",padding:"16px 0"},children:[e.jsx(A.TextArea,{value:r,onChange:t=>p(t.target.value),onKeyPress:E,placeholder:"Escribe tu mensaje...",autoSize:{minRows:1,maxRows:4},disabled:l,style:{flex:1}}),e.jsx(T,{type:"primary",icon:e.jsx(K,{}),onClick:m,loading:l,style:{height:"auto"}})]}),l&&e.jsxs("div",{style:{textAlign:"center",margin:"8px 0"},children:[e.jsx(H,{})," ",e.jsx(d,{type:"secondary",children:"El bot est√° escribiendo..."})]})]})})]})},V=z.createRoot(document.getElementById("chatbot"));V.render(e.jsx(N,{}));
